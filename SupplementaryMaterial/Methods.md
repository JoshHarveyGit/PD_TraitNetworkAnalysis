## Parkinson’s Sample Summary 
PD samples profiled in this study have been summarized previously23. Tissue for 134 unique individuals was sourced from the Parkinson’s Disease UK Brain Bank, covering the Substantia Nigra (SN), Caudate Nucleus (CN) and Frontal Cortex (FC). Samples were excluded for having atypical parkinsonism noted on pathology reports or early onset of disease (age of onset < 40). For analysis, case notes where assessed for lifetime prevalence of secondary symptoms of depression, anxiety, aggression, dementia, hallucinations and sleep disturbance. Years of disease, as defined for the number of years between diagnosis and death was also annotated as a separate outcome.  

## DNA methylation profiling
Genome wide DNA methylation was profiled using the Illumina 450K methylation array which interrogates ~450,000 methylation sites across the genome. Data underwent stringent quality control and normalisation as previously described using functions available in the wateRmelon R package. Samples with low median methylated or unmethylated intensities (< 2000, n = 0 samples) where removed and low bisulfite conversion percentages as determined using the bscon() function (<90%, n = 2 samples) were removed for low quality. Using a principle component (PC) based method, samples were tested for overlap of reported and predicted biological sex and removed if discordant (n = 2 samples).  Using SNP probes included on the array, samples were checked for expected genetic relatedness for replicates across multiple brain regions (n = 12 removed for discordant expected relatedness). Using the pfilter() function samples were excluded if >1% of probes showed a detection value > 0.05 (n = 0 samples) and probes were excluded if showing >1% of samples with detection value >0.05 or beadcount <3 in 5% of samples (n = 2,411 probes).  Samples were tested for outliers using the outlyx() function and visually assessed using PC analysis. As a subtle separation of data points on the PC analysis could be seen corresponding to the different brain regions, it was decided to normalise each brain region separately. Quantile normalisation was conducted using the dasen() function with default settings. Normalisation violence was assessed using the qual() function to determine samples with high degrees of difference between raw and normalized beta values, with no outlying samples apparent.

## Weighted Gene Correlation Network Analysis
Data processing and module detection: Due to the high number of CpG sites tested on the Illumina 450K array and the low groupwise sample size available for this sample set, we aimed to reduce the multiple testing burden for association using Weighted Gene Correlation Network Analysis (WGCNA)25. WGCNA determines correlation networks present within a given dataset to identify distinct clusters of highly correlated data-points which may hold functional relevance based on its significant pairwise relationship to other datapoints. Datasets were first filtered for variable probes across each brain region separately as determined by median absolute deviation (MAD) for any individual probe > median MAD for the entire dataset. To ensure consistent probes were being fed into each analysis per brain region, all probes passing this threshold in each brain region were included for further analysis, resulting in a set of 243,783 probes. Following this all brain regions were processed separately. To reduce the effect of unwanted technical and biological variance, multiple regression was used to regress out these effects from the dataset. Each CpG site was regressed against age, sex, technical batch, NeuN+ predicted cell proportion and post mortem interval. The residuals from this regression were extracted and added to the intercept to give a methylation value controlling for the applied covariates and scaled similarly to the raw value. Residual corrected methylation values were then clustered by Euclidean distance and the first four principle components were visually assessed to test for outlying samples. From this analysis two samples were removed from the SN, one from the FC and one from the CN. Co-methylation network and module detection were determined in a block-wise method and set as unsigned, so as to weight correlation between probes irrespective of the direction of correlation. As recommended in the WGCNA protocol, soft thresholding was applied, which raises the power of each correlation to a particular value with aim to reduce noise within the dataset. A scale free topology graph was constructed for powers ranging from 1-20 in stepwise increments and assessed for balance between scale free topology and connectivity. From this, a value of eight was selected for the SN, 12 for the FC and nine for the CN (Supplementary Figure X). Finally, modules were identified using the blockwiseModules() function (unsigned network, min size = 100, max size = 10000).
Module Trait Association Analysis:  Identified modules ranged in size and similarity and were labelled based on an arbitrary color value determined by the WGCNA process. Modules were additionally filtered at this point to remove any remaining modules retaining any significant (P <0.05) confounding trait association. For association testing, CpGs present within each module were aggregated into individual values representative of a weighted average of methylation within that module. These values, termed module eigengenes (MEs) are calculated using the eigenvalues from the first principal component for all methylation values in that modules with one module eigengene value determined for each individual case in the dataset per module. These module eigengenes were tested for association with phenotypic traits, using Pearsons correlation for continuous traits and Spearmans correlation for binary traits. For multiple testing correction, Bonferroni correction was applied as 0.05 divided by the number of modules present in that particular brain region.  

### Module membership analysis:  
For modules that showed significant association with any of the outcomes tested, individual relevant probes were assessed based on module membership (MM) and probe significance (PS). MM is calculated using person correlation between an individual probe and the ME of the module it is assigned and is thus representative of that individual probes connectivity to the rest of the module. PS was determined using correlation analysis between individual methylation values and the trait found to be significantly associated with that modules eigengene in the same method as for overall ME association.  MM was tested against –log10 transformed PS using pearson correlation. 
### Ontological enrichment analysis:  
For ontological enrichment analysis, annotated gene-symbols from the Illumina manifest file were extracted for the corresponding modules. A background of all annotated gene-symbols for all 243,783 probes fed into the analysis was used. Modules were tested for ontological terms using clusterProfiler().Modules were also tested for ontological terms for biological pathways enriched in CpGs present within each module using Gene Ontology (GO) and Kyoto Encyclopedia of Genes and Genomes (KEGG) analysis both using the missMethyl package. 

## Single cell data processing and cell enrichment analysis
To determine the sub cellular localisation of annotated genes determined from the WGCNA analysis, human SN single nuclei RNA sequencing (snRNAseq) data generated using the 10X Genomics (v.3) kit for the Kamath et al. 202214 publication was sourced from the Broad Institute Single Cell Portal https://singlecell.broadinstitute.org/single_cell/study/SCP1768/ . Filtered human single nuclei barcodes, gene features and expression matrix along with processed UMAPs and metadata were downloaded and processed. Data was loaded using the Read10X() function in the Seurat R package. Loaded data was converted to a summarized experiment object using the SummarizedExperiment() function in the R package of the same name. colData for each profiled cell was assigned from the corresponding celltypes based on annotations from the UMAP files as determined from the original publication and annotated at two levels of granularity. From this a set of 37,389 genes were taken forward.  Data was then processed for Expression Weighted Cell Type Enrichment analysis using functions within the EWCE26 package (https://github.com/NathanSkene/EWCE). Firstly genes with no overall expression (n = 4236 genes) or no significant differential expression between cell types (n = 3,532 genes at FDR adjusted p-value threshold <1e-05) were removed using the drop_uninformative_genes() function with the Limma setting. A normalized mean expression and specificity cell type dataset was calculated using the generate_celltype_data() function. Data quality was assessed at this point for potential artefacts by visual assessment of known marker gene expression in known cell types using the plot_ctd() function. Genes annotated to methylated loci in each module determined from WGCNA were tested separately for cell type enrichment using the bootstrap_enrichment_test() function. Tests were conducted over 100,000 repetitions and tested for cell type and sub-cell type enrichment separately Supplementary 1. Significant cell type enrichment was determined by Benjamini-Hochberg corrected P-values < 0.05. For plotting, similar modules were determined based on Euclidean distance of a binary significance module by cell type matrix.

